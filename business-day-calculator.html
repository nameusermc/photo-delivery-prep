<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0BSK4FMVEZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-0BSK4FMVEZ');
    </script>
    <meta name="p:domain_verify" content="22dded8e603afa3dc4253ce1ac4a6248" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free Business Day Calculator - Count working days between dates or find a date N business days from now. Excludes weekends automatically for accurate deadline planning.">
    <meta name="keywords" content="business day calculator, working days calculator, weekday counter, deadline calculator, work day planner">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://freemicrotools.app/business-day-calculator.html">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <title>Business Day Calculator ‚Äî Free Working Days Tool | Free Micro Tools</title>
    

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Free Micro Web Tools">
    <meta property="og:title" content="Business Day Calculator ‚Äî Free Working Days Tool | Free Micro Tools">
    <meta property="og:description" content="Free Business Day Calculator - Count working days between dates or find a date N business days from now. Excludes weekends automatically for accurate deadline planning.">
    <meta property="og:url" content="https://freemicrotools.app/business-day-calculator.html">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Business Day Calculator ‚Äî Free Working Days Tool | Free Micro Tools">
    <meta name="twitter:description" content="Free Business Day Calculator - Count working days between dates or find a date N business days from now. Excludes weekends automatically for accurate deadline planning.">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Business Day Calculator",
        "description": "Count working days between dates or calculate target dates excluding weekends",
        "url": "https://freemicrotools.app/business-day-calculator.html",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    <style>
        /* ========== CSS Reset & Base Styles ========== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary: #0891b2;
            --primary-dark: #0e7490;
            --primary-light: #cffafe;
            --success: #10b981;
            --warning: #f59e0b;
            --bg: #ecfeff;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 1rem;
        }

        /* ========== Layout ========== */
        .container {
            max-width: 520px;
            margin: 0 auto;
        }

        /* ========== Card Component ========== */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .card-subtitle {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
        }

        /* ========== Mode Tabs ========== */
        .mode-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: #f1f5f9;
            padding: 0.375rem;
            border-radius: 10px;
        }

        .mode-tab {
            flex: 1;
            padding: 0.75rem 0.5rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 0.8125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
            color: var(--text-muted);
        }

        .mode-tab:hover {
            background: white;
            color: var(--text);
        }

        .mode-tab.active {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow);
        }

        /* ========== Form Elements ========== */
        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        input[type="date"],
        input[type="number"] {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: white;
        }

        input[type="date"]:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(8, 145, 178, 0.1);
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-hint {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        /* ========== Direction Toggle ========== */
        .direction-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
        }

        .direction-btn {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--border);
            background: white;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }

        .direction-btn:hover {
            border-color: var(--primary);
        }

        .direction-btn.active {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        /* ========== Section Toggle ========== */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* ========== Calculate Button ========== */
        .btn-calculate {
            width: 100%;
            padding: 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .btn-calculate:hover {
            background: var(--primary-dark);
        }

        .btn-calculate:active {
            transform: scale(0.98);
        }

        /* ========== Results Section ========== */
        .results {
            display: none;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--border);
        }

        .results.show { display: block; }

        .result-highlight {
            background: linear-gradient(135deg, var(--primary), var(--success));
            color: white;
            padding: 1.25rem;
            border-radius: 8px;
            text-align: center;
        }

        .result-highlight .result-label {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .result-highlight .result-value {
            font-size: 2.25rem;
            font-weight: 800;
            line-height: 1.2;
        }

        .result-highlight .result-unit {
            font-size: 0.9375rem;
            font-weight: 600;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        /* ========== Date Result Card ========== */
        .date-result-card {
            background: linear-gradient(135deg, var(--primary), var(--success));
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .date-result-label {
            font-size: 0.875rem;
            opacity: 0.85;
            margin-bottom: 0.5rem;
        }

        .date-result-value {
            font-size: 1.5rem;
            font-weight: 800;
            line-height: 1.3;
        }

        .date-result-weekday {
            font-size: 1rem;
            font-weight: 600;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        /* ========== Stats Grid ========== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .stat-card {
            background: #f8fafc;
            border-radius: 8px;
            padding: 0.75rem;
            text-align: center;
        }

        .stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.6875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }

        /* ========== Summary Box ========== */
        .summary-box {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .summary-text {
            font-size: 0.875rem;
            color: var(--text);
            line-height: 1.5;
        }

        .summary-text strong {
            color: var(--primary-dark);
        }

        /* ========== Instructions Section ========== */
        .instructions {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .instructions h3 {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .instructions ul {
            margin-left: 1.25rem;
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        .instructions li {
            margin-bottom: 0.25rem;
        }

        /* ========== Error State ========== */
        .error {
            border-color: #ef4444 !important;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }

        .error-message.show { display: block; }

        /* ========== Footer ========== */
        footer {
            text-align: center;
            padding: 1.5rem 1rem;
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 0.75rem;
        }

        .footer-links a {
            color: var(--text-muted);
            text-decoration: none;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* ========== Tool Description ========== */
        .tool-description {
            background: linear-gradient(135deg, #ecfeff 0%, #cffafe 100%);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .tool-description p {
            margin: 0;
            color: var(--text);
        }

        /* ========== Responsive ========== */
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .mode-tab {
                font-size: 0.75rem;
                padding: 0.625rem 0.375rem;
            }
        }

        </style>
</head>
<body>
    <div class="container">
        <a href="index.html">‚Üê Back to Tools</a>
<!-- Tool Description -->
        <div class="tool-description">
            <p>Calculate business days between dates or find a target date by adding/subtracting working days. Excludes weekends (Sat‚ÄìSun).</p>
        </div>

        <!-- Main Calculator Card -->
        <main class="card">
            <h1 class="card-title">üìÖ Business Day Calculator</h1>
            <p class="card-subtitle">Count or add working days (Mon‚ÄìFri)</p>

            <!-- Mode Tabs -->
            <div class="mode-tabs">
                <button class="mode-tab active" data-mode="between">
                    <span>üìä</span> Between Dates
                </button>
                <button class="mode-tab" data-mode="addsubtract">
                    <span>‚ûï</span> Add/Subtract Days
                </button>
            </div>

            <!-- ========== MODE 1: Between Dates ========== -->
            <div class="section active" id="betweenSection">
                <form id="betweenForm" novalidate>
                    <div class="form-group">
                        <label for="startDate1">Start Date</label>
                        <input type="date" id="startDate1" required>
                        <span id="startError1" class="error-message">Please select a start date</span>
                    </div>

                    <div class="form-group">
                        <label for="endDate1">End Date</label>
                        <input type="date" id="endDate1" required>
                        <span id="endError1" class="error-message">Please select an end date</span>
                    </div>

                    <button type="submit" class="btn-calculate">Calculate Business Days</button>
                </form>

                <div id="results1" class="results">
                    <div class="result-highlight">
                        <div class="result-label">Business Days (Mon‚ÄìFri)</div>
                        <div class="result-value" id="resultBusinessDays">0</div>
                        <div class="result-unit">working days</div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="resultTotalDays">0</div>
                            <div class="stat-label">Total Days</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="resultWeekendDays">0</div>
                            <div class="stat-label">Weekend Days</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="resultWeeks">0</div>
                            <div class="stat-label">Full Weeks</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="resultMonths">0</div>
                            <div class="stat-label">~Months</div>
                        </div>
                    </div>

                    <div class="summary-box">
                        <div class="summary-text" id="summaryText1">-</div>
                    </div>
                </div>
            </div>

            <!-- ========== MODE 2: Add/Subtract Business Days ========== -->
            <div class="section" id="addsubtractSection">
                <form id="addsubtractForm" novalidate>
                    <div class="form-group">
                        <label for="startDate2">Start Date</label>
                        <input type="date" id="startDate2" required>
                        <span id="startError2" class="error-message">Please select a start date</span>
                    </div>

                    <div class="direction-toggle">
                        <button type="button" class="direction-btn active" data-direction="add">
                            <span>‚ûï</span> Add Days
                        </button>
                        <button type="button" class="direction-btn" data-direction="subtract">
                            <span>‚ûñ</span> Subtract Days
                        </button>
                    </div>

                    <div class="form-group">
                        <label for="numDays">Number of Business Days</label>
                        <input type="number" id="numDays" placeholder="e.g. 10" min="1" max="9999" required>
                        <div class="input-hint">Enter working days to add or subtract</div>
                        <span id="daysError" class="error-message">Please enter a valid number</span>
                    </div>

                    <button type="submit" class="btn-calculate">Calculate Target Date</button>
                </form>

                <div id="results2" class="results">
                    <div class="date-result-card">
                        <div class="date-result-label" id="resultDirection">After adding 0 business days:</div>
                        <div class="date-result-value" id="resultTargetDate">-</div>
                        <div class="date-result-weekday" id="resultWeekday">-</div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="resultCalendarDays">0</div>
                            <div class="stat-label">Calendar Days</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="resultSkippedWeekends">0</div>
                            <div class="stat-label">Weekends Skipped</div>
                        </div>
                    </div>

                    <div class="summary-box">
                        <div class="summary-text" id="summaryText2">-</div>
                    </div>
                </div>
            </div>
<!-- Usage Instructions --><div class="instructions">
                <h3>üìñ How to Use</h3>
                <ul>
                    <li><strong>Between Dates:</strong> Count business days between two dates</li>
                    <li><strong>Add/Subtract:</strong> Find a date N business days from start</li>
                    <li>Business days = Monday through Friday</li>
                    <li>Weekends (Sat & Sun) are excluded</li>
                    <li>Holidays are not excluded (simple calculation)</li>
                </ul>
            </div>
        </main>
<footer>
            <p>¬© 2026 Free Micro Web Tools. All tools are free to use.</p>
            <div class="footer-links">
                <a href="about.html">About</a>
                <a href="contact.html">Contact</a>
                <a href="privacy.html">Privacy</a>
                <a href="terms.html">Terms</a>
            </div>
        </footer>
    </div>

    <script>
        /**
         * Business Day Calculator
         * Mode 1: Count business days between two dates
         * Mode 2: Add/subtract business days to find target date
         * Pure vanilla JavaScript - client-side only
         */
        (function() {
            'use strict';

            // ========== DOM References ==========
            const modeTabs = document.querySelectorAll('.mode-tab');
            const sections = document.querySelectorAll('.section');

            // Mode 1: Between Dates
            const betweenForm = document.getElementById('betweenForm');
            const startDate1 = document.getElementById('startDate1');
            const endDate1 = document.getElementById('endDate1');
            const startError1 = document.getElementById('startError1');
            const endError1 = document.getElementById('endError1');
            const results1 = document.getElementById('results1');
            const resultBusinessDays = document.getElementById('resultBusinessDays');
            const resultTotalDays = document.getElementById('resultTotalDays');
            const resultWeekendDays = document.getElementById('resultWeekendDays');
            const resultWeeks = document.getElementById('resultWeeks');
            const resultMonths = document.getElementById('resultMonths');
            const summaryText1 = document.getElementById('summaryText1');

            // Mode 2: Add/Subtract
            const addsubtractForm = document.getElementById('addsubtractForm');
            const startDate2 = document.getElementById('startDate2');
            const numDays = document.getElementById('numDays');
            const directionBtns = document.querySelectorAll('.direction-btn');
            const startError2 = document.getElementById('startError2');
            const daysError = document.getElementById('daysError');
            const results2 = document.getElementById('results2');
            const resultDirection = document.getElementById('resultDirection');
            const resultTargetDate = document.getElementById('resultTargetDate');
            const resultWeekday = document.getElementById('resultWeekday');
            const resultCalendarDays = document.getElementById('resultCalendarDays');
            const resultSkippedWeekends = document.getElementById('resultSkippedWeekends');
            const summaryText2 = document.getElementById('summaryText2');

            // State
            let direction = 'add';

            // ========== Utility Functions ==========

            /**
             * Format date for display
             */
            function formatDate(date) {
                return date.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }

            /**
             * Format short date
             */
            function formatShortDate(date) {
                return date.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                });
            }

            /**
             * Get weekday name
             */
            function getWeekdayName(date) {
                return date.toLocaleDateString('en-US', { weekday: 'long' });
            }

            /**
             * Check if a date is a weekend (Saturday=6, Sunday=0)
             */
            function isWeekend(date) {
                const day = date.getDay();
                return day === 0 || day === 6;
            }

            /**
             * Calculate business days between two dates (inclusive of both if business days)
             */
            function calculateBusinessDays(start, end) {
                // Swap if needed
                if (start > end) {
                    [start, end] = [end, start];
                }

                let count = 0;
                const current = new Date(start);

                while (current <= end) {
                    if (!isWeekend(current)) {
                        count++;
                    }
                    current.setDate(current.getDate() + 1);
                }

                return count;
            }

            /**
             * Calculate total calendar days (inclusive)
             */
            function calculateTotalDays(start, end) {
                if (start > end) {
                    [start, end] = [end, start];
                }
                const diffTime = Math.abs(end - start);
                return Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
            }

            /**
             * Add N business days to a date
             */
            function addBusinessDays(startDate, numBusinessDays) {
                const result = new Date(startDate);
                let daysAdded = 0;
                let weekendsSkipped = 0;

                while (daysAdded < numBusinessDays) {
                    result.setDate(result.getDate() + 1);
                    if (isWeekend(result)) {
                        weekendsSkipped++;
                    } else {
                        daysAdded++;
                    }
                }

                return { date: result, weekendsSkipped };
            }

            /**
             * Subtract N business days from a date
             */
            function subtractBusinessDays(startDate, numBusinessDays) {
                const result = new Date(startDate);
                let daysSubtracted = 0;
                let weekendsSkipped = 0;

                while (daysSubtracted < numBusinessDays) {
                    result.setDate(result.getDate() - 1);
                    if (isWeekend(result)) {
                        weekendsSkipped++;
                    } else {
                        daysSubtracted++;
                    }
                }

                return { date: result, weekendsSkipped };
            }

            /**
             * Toggle error state
             */
            function toggleError(input, errorEl, show) {
                if (show) {
                    input.classList.add('error');
                    errorEl.classList.add('show');
                } else {
                    input.classList.remove('error');
                    errorEl.classList.remove('show');
                }
            }

            // ========== Mode Switching ==========

            modeTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const mode = tab.dataset.mode;

                    modeTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    sections.forEach(s => s.classList.remove('active'));
                    document.getElementById(`${mode}Section`).classList.add('active');
                });
            });

            // ========== Direction Toggle ==========

            directionBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    direction = btn.dataset.direction;
                    directionBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });

            // ========== Mode 1: Between Dates ==========

            betweenForm.addEventListener('submit', (e) => {
                e.preventDefault();

                let valid = true;

                if (!startDate1.value) {
                    toggleError(startDate1, startError1, true);
                    valid = false;
                } else {
                    toggleError(startDate1, startError1, false);
                }

                if (!endDate1.value) {
                    toggleError(endDate1, endError1, true);
                    valid = false;
                } else {
                    toggleError(endDate1, endError1, false);
                }

                if (!valid) return;

                // Parse dates
                const start = new Date(startDate1.value + 'T00:00:00');
                const end = new Date(endDate1.value + 'T00:00:00');

                // Ensure proper order for display
                let displayStart = start;
                let displayEnd = end;
                if (start > end) {
                    displayStart = end;
                    displayEnd = start;
                }

                // Calculate
                const businessDays = calculateBusinessDays(start, end);
                const totalDays = calculateTotalDays(start, end);
                const weekendDays = totalDays - businessDays;
                const fullWeeks = Math.floor(totalDays / 7);
                const approxMonths = (totalDays / 30.44).toFixed(1);

                // Update results
                resultBusinessDays.textContent = businessDays.toLocaleString();
                resultTotalDays.textContent = totalDays.toLocaleString();
                resultWeekendDays.textContent = weekendDays.toLocaleString();
                resultWeeks.textContent = fullWeeks.toLocaleString();
                resultMonths.textContent = approxMonths;

                // Summary
                summaryText1.innerHTML = `From <strong>${formatShortDate(displayStart)}</strong> to <strong>${formatShortDate(displayEnd)}</strong>, there are <strong>${businessDays} business days</strong> (excluding ${weekendDays} weekend days).`;

                results1.classList.add('show');
            });

            // Clear errors on input
            startDate1.addEventListener('change', () => toggleError(startDate1, startError1, false));
            endDate1.addEventListener('change', () => toggleError(endDate1, endError1, false));

            // ========== Mode 2: Add/Subtract ==========

            addsubtractForm.addEventListener('submit', (e) => {
                e.preventDefault();

                let valid = true;

                if (!startDate2.value) {
                    toggleError(startDate2, startError2, true);
                    valid = false;
                } else {
                    toggleError(startDate2, startError2, false);
                }

                const days = parseInt(numDays.value);
                if (!numDays.value || isNaN(days) || days < 1) {
                    toggleError(numDays, daysError, true);
                    valid = false;
                } else {
                    toggleError(numDays, daysError, false);
                }

                if (!valid) return;

                // Parse start date
                const start = new Date(startDate2.value + 'T00:00:00');

                // Calculate
                let result;
                if (direction === 'add') {
                    result = addBusinessDays(start, days);
                    resultDirection.textContent = `After adding ${days} business day${days === 1 ? '' : 's'}:`;
                } else {
                    result = subtractBusinessDays(start, days);
                    resultDirection.textContent = `After subtracting ${days} business day${days === 1 ? '' : 's'}:`;
                }

                const targetDate = result.date;
                const calendarDays = calculateTotalDays(start, targetDate) - 1; // Exclude start date

                // Update results
                resultTargetDate.textContent = formatShortDate(targetDate);
                resultWeekday.textContent = getWeekdayName(targetDate);
                resultCalendarDays.textContent = calendarDays.toLocaleString();
                resultSkippedWeekends.textContent = result.weekendsSkipped.toLocaleString();

                // Summary
                const verb = direction === 'add' ? 'after' : 'before';
                summaryText2.innerHTML = `<strong>${days} business day${days === 1 ? '' : 's'}</strong> ${verb} <strong>${formatShortDate(start)}</strong> is <strong>${formatDate(targetDate)}</strong>.`;

                results2.classList.add('show');
            });

            // Clear errors on input
            startDate2.addEventListener('change', () => toggleError(startDate2, startError2, false));
            numDays.addEventListener('input', () => toggleError(numDays, daysError, false));

            // ========== Initialize ==========

            // Set default dates
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            const future = new Date();
            future.setDate(today.getDate() + 30);
            const futureStr = future.toISOString().split('T')[0];

            startDate1.value = todayStr;
            endDate1.value = futureStr;
            startDate2.value = todayStr;

        })();
    </script>

    <!-- GA4 Event Tracking -->
    <script>
        (function() {
            // Track tool page landing
            gtag('event', 'tool_landed', {
                'tool_name': 'Business Day Calculator'
            });
            
            // Track tool usage
            function trackToolUsed(inputCount, customValuesUsed, resultGenerated) {
                gtag('event', 'tool_used', {
                    'tool_name': 'Business Day Calculator',
                    'input_count': inputCount || 0,
                    'custom_values_used': customValuesUsed || false,
                    'result_generated': resultGenerated || false
                });
            }
            
            // Expose tracking function globally for this tool
            window.trackToolUsed = trackToolUsed;
        })();
    </script>
</body>
</html>
