<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0BSK4FMVEZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-0BSK4FMVEZ');
    </script>
    <meta name="p:domain_verify" content="22dded8e603afa3dc4253ce1ac4a6248" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free CSV Line Combiner / Splitter - Split large lists into chunks or combine CSV columns into single lines. Auto-detects delimiters. Perfect for batch processing and data cleanup.">
    <meta name="keywords" content="csv splitter, csv combiner, text splitter, list chunker, csv tool, data processing tool">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://freemicrotools.app/csv-line-combiner.html">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <title>CSV Line Combiner / Splitter ‚Äî Free Data Tool | Free Micro Tools</title>
    

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Free Micro Web Tools">
    <meta property="og:title" content="CSV Line Combiner / Splitter ‚Äî Free Data Tool | Free Micro Tools">
    <meta property="og:description" content="Free CSV Line Combiner / Splitter - Split large lists into chunks or combine CSV columns into single lines. Auto-detects delimiters. Perfect for batch processing and data cleanup.">
    <meta property="og:url" content="https://freemicrotools.app/csv-line-combiner.html">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="CSV Line Combiner / Splitter ‚Äî Free Data Tool | Free Micro Tools">
    <meta name="twitter:description" content="Free CSV Line Combiner / Splitter - Split large lists into chunks or combine CSV columns into single lines. Auto-detects delimiters. Perfect for batch processing and data cleanup.">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "CSV Line Combiner / Splitter",
        "description": "Split lists into chunks or combine CSV columns with auto-delimiter detection",
        "url": "https://freemicrotools.app/csv-line-combiner.html",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    <style>
        /* ========== CSS Reset & Base Styles ========== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #ede9fe;
            --success: #10b981;
            --warning: #f59e0b;
            --bg: #f5f3ff;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 1rem;
        }

        /* ========== Layout ========== */
        .container {
            max-width: 680px;
            margin: 0 auto;
        }

        /* ========== Card Component ========== */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .card-subtitle {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
        }

        /* ========== Mode Tabs ========== */
        .mode-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: #f1f5f9;
            padding: 0.375rem;
            border-radius: 10px;
        }

        .mode-tab {
            flex: 1;
            padding: 0.75rem 0.5rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
            color: var(--text-muted);
        }

        .mode-tab:hover {
            background: white;
            color: var(--text);
        }

        .mode-tab.active {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow);
        }

        /* ========== Section Toggle ========== */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* ========== Form Elements ========== */
        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.875rem;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: #fafafa;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
            background: white;
        }

        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: white;
        }

        input[type="number"]:focus,
        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-hint {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        /* ========== Options Grid ========== */
        .options-row {
            display: flex;
            gap: 0.75rem;
            align-items: end;
        }

        .options-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        /* ========== Checkbox ========== */
        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 8px;
        }

        .checkbox-row input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .checkbox-row label {
            margin-bottom: 0;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.875rem;
        }

        /* ========== Action Buttons ========== */
        .btn-row {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            flex: 1;
            padding: 0.875rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: white;
            border: 2px solid var(--border);
            color: var(--text);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn:active {
            transform: scale(0.98);
        }

        /* ========== Output Section ========== */
        .output-section {
            display: none;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--border);
        }

        .output-section.show {
            display: block;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .output-title {
            font-weight: 700;
            font-size: 0.9375rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .output-stats {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .btn-copy {
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.8125rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-copy:hover {
            background: var(--primary-dark);
        }

        .output-textarea {
            background: #f8fafc;
            border: 2px solid var(--border);
        }

        /* ========== Chunks Container ========== */
        .chunks-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .chunk-box {
            background: #f8fafc;
            border: 2px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .chunk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.625rem 1rem;
            background: var(--primary-light);
            border-bottom: 1px solid var(--border);
        }

        .chunk-title {
            font-weight: 600;
            font-size: 0.8125rem;
            color: var(--primary-dark);
        }

        .chunk-count {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .chunk-content {
            padding: 0.75rem 1rem;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.8125rem;
            line-height: 1.5;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }

        .chunk-copy-btn {
            padding: 0.25rem 0.625rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.6875rem;
            font-weight: 600;
            cursor: pointer;
        }

        .chunk-copy-btn:hover {
            background: var(--primary-dark);
        }

        /* ========== Stats Bar ========== */
        .stats-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            padding: 0.75rem 1rem;
            background: var(--primary-light);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            font-size: 0.8125rem;
        }

        .stat-label {
            color: var(--text-muted);
        }

        .stat-value {
            font-weight: 700;
            color: var(--primary-dark);
        }

        /* ========== Instructions Section ========== */
        .instructions {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .instructions h3 {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .instructions ul {
            margin-left: 1.25rem;
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        .instructions li {
            margin-bottom: 0.25rem;
        }

        /* ========== Toast ========== */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--text);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* ========== Footer ========== */
        footer {
            text-align: center;
            padding: 1.5rem 1rem;
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 0.75rem;
        }

        .footer-links a {
            color: var(--text-muted);
            text-decoration: none;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* ========== Tool Description ========== */
        .tool-description {
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .tool-description p {
            margin: 0;
            color: var(--text);
        }

        /* ========== Responsive ========== */
        @media (max-width: 500px) {
            .form-row,
            .options-row {
                grid-template-columns: 1fr;
                flex-direction: column;
            }

            .btn-row {
                flex-direction: column;
            }

            .stats-bar {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        </style>
</head>
<body>
    <div class="container">
        <a href="index.html">‚Üê Back to Tools</a>
<!-- Tool Description -->
        <div class="tool-description">
            <p>Split large lists into smaller chunks or combine CSV columns into single lines. Perfect for batch processing, data cleanup, and list management.</p>
        </div>

        <!-- Main Tool Card -->
        <main class="card">
            <h1 class="card-title">üìã CSV Line Combiner / Splitter</h1>
            <p class="card-subtitle">Split lists into chunks or combine columns</p>

            <!-- Mode Tabs -->
            <div class="mode-tabs">
                <button class="mode-tab active" data-mode="split">
                    <span>‚úÇÔ∏è</span> Split into Chunks
                </button>
                <button class="mode-tab" data-mode="combine">
                    <span>üîó</span> Combine Columns
                </button>
            </div>

            <!-- ========== MODE 1: Split into Chunks ========== -->
            <div class="section active" id="splitSection">
                <div class="form-group">
                    <label for="splitInput">Paste Your List</label>
                    <textarea id="splitInput" rows="8" placeholder="Paste your list here (one item per line)...

Example:
item1
item2
item3
item4
item5"></textarea>
                    <div class="input-hint">One item per line</div>
                </div>

                <div class="options-row">
                    <div class="form-group">
                        <label for="chunkSize">Lines Per Chunk</label>
                        <input type="number" id="chunkSize" value="10" min="1" max="10000">
                    </div>
                    <div class="form-group">
                        <label for="splitDelimiter">Output Delimiter</label>
                        <select id="splitDelimiter">
                            <option value="newline">New Line</option>
                            <option value="comma">Comma</option>
                            <option value="semicolon">Semicolon</option>
                            <option value="tab">Tab</option>
                            <option value="space">Space</option>
                        </select>
                    </div>
                </div>

                <div class="checkbox-row">
                    <input type="checkbox" id="trimLines" checked>
                    <label for="trimLines">Trim whitespace from each line</label>
                </div>

                <div class="checkbox-row">
                    <input type="checkbox" id="removeEmpty" checked>
                    <label for="removeEmpty">Remove empty lines</label>
                </div>

                <div class="btn-row">
                    <button type="button" class="btn btn-primary" id="splitBtn">
                        <span>‚úÇÔ∏è</span> Split List
                    </button>
                    <button type="button" class="btn btn-secondary" id="clearSplitBtn">
                        <span>üóëÔ∏è</span> Clear
                    </button>
                </div>

                <div class="output-section" id="splitOutput">
                    <div class="stats-bar" id="splitStats">
                        <div class="stat-item">
                            <span class="stat-label">Total Lines:</span>
                            <span class="stat-value" id="statTotalLines">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Chunks:</span>
                            <span class="stat-value" id="statChunks">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Lines/Chunk:</span>
                            <span class="stat-value" id="statLinesPerChunk">0</span>
                        </div>
                    </div>

                    <div class="output-header">
                        <span class="output-title">
                            <span>üì¶</span> Output Chunks
                        </span>
                        <button type="button" class="btn-copy" id="copyAllChunksBtn">
                            üìã Copy All
                        </button>
                    </div>

                    <div class="chunks-container" id="chunksContainer">
                        <!-- Chunks will be generated here -->
                    </div>
                </div>
            </div>

            <!-- ========== MODE 2: Combine Columns ========== -->
            <div class="section" id="combineSection">
                <div class="form-group">
                    <label for="combineInput">Paste Your CSV / Multi-Column Data</label>
                    <textarea id="combineInput" rows="8" placeholder="Paste CSV or tab-separated data here...

Example:
John,Doe,john@email.com
Jane,Smith,jane@email.com

Or:
John	Doe	john@email.com
Jane	Smith	jane@email.com"></textarea>
                    <div class="input-hint">CSV, tab-separated, or any delimited data</div>
                </div>

                <div class="options-row">
                    <div class="form-group">
                        <label for="inputDelimiter">Input Delimiter</label>
                        <select id="inputDelimiter">
                            <option value="auto">Auto-detect</option>
                            <option value=",">Comma (,)</option>
                            <option value=";">Semicolon (;)</option>
                            <option value="\t">Tab</option>
                            <option value="|">Pipe (|)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="outputJoiner">Combine With</label>
                        <select id="outputJoiner">
                            <option value=" ">Space</option>
                            <option value=", ">Comma + Space</option>
                            <option value=",">Comma</option>
                            <option value=" - ">Dash</option>
                            <option value=" | ">Pipe</option>
                            <option value="">Nothing (concat)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="columnSelect">Columns to Combine (optional)</label>
                    <input type="text" id="columnSelect" placeholder="e.g. 1,2,3 or leave blank for all">
                    <div class="input-hint">Specify column numbers (1-indexed) or leave blank for all columns</div>
                </div>

                <div class="checkbox-row">
                    <input type="checkbox" id="skipHeader">
                    <label for="skipHeader">Skip first row (header)</label>
                </div>

                <div class="btn-row">
                    <button type="button" class="btn btn-primary" id="combineBtn">
                        <span>üîó</span> Combine Columns
                    </button>
                    <button type="button" class="btn btn-secondary" id="clearCombineBtn">
                        <span>üóëÔ∏è</span> Clear
                    </button>
                </div>

                <div class="output-section" id="combineOutput">
                    <div class="stats-bar" id="combineStats">
                        <div class="stat-item">
                            <span class="stat-label">Rows:</span>
                            <span class="stat-value" id="statRows">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Columns Detected:</span>
                            <span class="stat-value" id="statCols">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Delimiter:</span>
                            <span class="stat-value" id="statDelimiter">-</span>
                        </div>
                    </div>

                    <div class="output-header">
                        <span class="output-title">
                            <span>‚úÖ</span> Combined Output
                        </span>
                        <button type="button" class="btn-copy" id="copyCombinedBtn">
                            üìã Copy
                        </button>
                    </div>

                    <textarea id="combineResultArea" class="output-textarea" rows="8" readonly></textarea>
                </div>
            </div>
<!-- Usage Instructions --><div class="instructions">
                <h3>üìñ How to Use</h3>
                <ul>
                    <li><strong>Split:</strong> Paste a list, set chunk size, get multiple smaller lists</li>
                    <li><strong>Combine:</strong> Paste CSV data, columns become single lines</li>
                    <li>Auto-detects delimiters (comma, tab, semicolon, pipe)</li>
                    <li>Choose output format for each chunk</li>
                    <li>Copy individual chunks or all at once</li>
                </ul>
            </div>
        </main>
<footer>
            <p>¬© 2026 Free Micro Web Tools. All tools are free to use.</p>
            <div class="footer-links">
                <a href="about.html">About</a>
                <a href="contact.html">Contact</a>
                <a href="privacy.html">Privacy</a>
                <a href="terms.html">Terms</a>
            </div>
        </footer>

        <!-- Toast Notification -->
        <div class="toast" id="toast">Copied!</div>
    </div>

    <script>
        /**
         * CSV Line Combiner / Splitter
         * Mode 1: Split list into chunks of N lines
         * Mode 2: Combine CSV columns into single lines
         * Pure vanilla JavaScript - client-side only
         */
        (function() {
            'use strict';

            // ========== DOM References ==========
            const modeTabs = document.querySelectorAll('.mode-tab');
            const sections = document.querySelectorAll('.section');
            const toast = document.getElementById('toast');

            // Split mode
            const splitInput = document.getElementById('splitInput');
            const chunkSize = document.getElementById('chunkSize');
            const splitDelimiter = document.getElementById('splitDelimiter');
            const trimLines = document.getElementById('trimLines');
            const removeEmpty = document.getElementById('removeEmpty');
            const splitBtn = document.getElementById('splitBtn');
            const clearSplitBtn = document.getElementById('clearSplitBtn');
            const splitOutput = document.getElementById('splitOutput');
            const chunksContainer = document.getElementById('chunksContainer');
            const copyAllChunksBtn = document.getElementById('copyAllChunksBtn');
            const statTotalLines = document.getElementById('statTotalLines');
            const statChunks = document.getElementById('statChunks');
            const statLinesPerChunk = document.getElementById('statLinesPerChunk');

            // Combine mode
            const combineInput = document.getElementById('combineInput');
            const inputDelimiter = document.getElementById('inputDelimiter');
            const outputJoiner = document.getElementById('outputJoiner');
            const columnSelect = document.getElementById('columnSelect');
            const skipHeader = document.getElementById('skipHeader');
            const combineBtn = document.getElementById('combineBtn');
            const clearCombineBtn = document.getElementById('clearCombineBtn');
            const combineOutput = document.getElementById('combineOutput');
            const combineResultArea = document.getElementById('combineResultArea');
            const copyCombinedBtn = document.getElementById('copyCombinedBtn');
            const statRows = document.getElementById('statRows');
            const statCols = document.getElementById('statCols');
            const statDelimiter = document.getElementById('statDelimiter');

            // State
            let currentChunks = [];

            // ========== Utility Functions ==========

            function showToast(message) {
                toast.textContent = message;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }

            async function copyToClipboard(text) {
                try {
                    await navigator.clipboard.writeText(text);
                    showToast('‚úì Copied to clipboard!');
                } catch (err) {
                    showToast('‚ùå Failed to copy');
                }
            }

            function getDelimiterChar(value) {
                const map = {
                    'newline': '\n',
                    'comma': ',',
                    'semicolon': ';',
                    'tab': '\t',
                    'space': ' '
                };
                return map[value] || '\n';
            }

            /**
             * Auto-detect CSV delimiter
             */
            function detectDelimiter(text) {
                const firstLine = text.split('\n')[0];
                const delimiters = [
                    { char: '\t', name: 'Tab' },
                    { char: ',', name: 'Comma' },
                    { char: ';', name: 'Semicolon' },
                    { char: '|', name: 'Pipe' }
                ];

                let best = { char: ',', name: 'Comma', count: 0 };

                for (const d of delimiters) {
                    const count = (firstLine.match(new RegExp(d.char === '|' ? '\\|' : d.char, 'g')) || []).length;
                    if (count > best.count) {
                        best = { ...d, count };
                    }
                }

                return best;
            }

            /**
             * Parse CSV line (handles quoted values)
             */
            function parseCSVLine(line, delimiter) {
                const result = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];

                    if (char === '"') {
                        if (inQuotes && line[i + 1] === '"') {
                            current += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === delimiter && !inQuotes) {
                        result.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }

                result.push(current.trim());
                return result;
            }

            // ========== Mode Switching ==========

            modeTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const mode = tab.dataset.mode;

                    modeTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    sections.forEach(s => s.classList.remove('active'));
                    document.getElementById(`${mode}Section`).classList.add('active');
                });
            });

            // ========== Mode 1: Split into Chunks ==========

            splitBtn.addEventListener('click', () => {
                const input = splitInput.value;

                if (!input.trim()) {
                    showToast('‚ö†Ô∏è Please paste some text');
                    return;
                }

                // Parse lines
                let lines = input.split(/\r?\n/);

                // Trim if needed
                if (trimLines.checked) {
                    lines = lines.map(l => l.trim());
                }

                // Remove empty if needed
                if (removeEmpty.checked) {
                    lines = lines.filter(l => l.length > 0);
                }

                if (lines.length === 0) {
                    showToast('‚ö†Ô∏è No lines to process');
                    return;
                }

                const size = Math.max(1, parseInt(chunkSize.value) || 10);
                const delimiter = getDelimiterChar(splitDelimiter.value);

                // Split into chunks
                currentChunks = [];
                for (let i = 0; i < lines.length; i += size) {
                    currentChunks.push(lines.slice(i, i + size));
                }

                // Update stats
                statTotalLines.textContent = lines.length.toLocaleString();
                statChunks.textContent = currentChunks.length.toLocaleString();
                statLinesPerChunk.textContent = size.toLocaleString();

                // Render chunks
                chunksContainer.innerHTML = '';

                currentChunks.forEach((chunk, index) => {
                    const chunkText = chunk.join(delimiter);
                    const chunkBox = document.createElement('div');
                    chunkBox.className = 'chunk-box';
                    chunkBox.innerHTML = `
                        <div class="chunk-header">
                            <span class="chunk-title">Chunk ${index + 1}</span>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <span class="chunk-count">${chunk.length} line${chunk.length !== 1 ? 's' : ''}</span>
                                <button class="chunk-copy-btn" data-index="${index}">Copy</button>
                            </div>
                        </div>
                        <div class="chunk-content">${escapeHtml(chunkText)}</div>
                    `;
                    chunksContainer.appendChild(chunkBox);
                });

                // Add copy listeners
                document.querySelectorAll('.chunk-copy-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const index = parseInt(btn.dataset.index);
                        const delimiter = getDelimiterChar(splitDelimiter.value);
                        copyToClipboard(currentChunks[index].join(delimiter));
                    });
                });

                splitOutput.classList.add('show');
                showToast(`‚úÇÔ∏è Split into ${currentChunks.length} chunks`);
            });

            clearSplitBtn.addEventListener('click', () => {
                splitInput.value = '';
                splitOutput.classList.remove('show');
                currentChunks = [];
            });

            copyAllChunksBtn.addEventListener('click', () => {
                if (currentChunks.length === 0) return;

                const delimiter = getDelimiterChar(splitDelimiter.value);
                const allText = currentChunks.map((chunk, i) => 
                    `--- Chunk ${i + 1} ---\n${chunk.join(delimiter)}`
                ).join('\n\n');

                copyToClipboard(allText);
            });

            // ========== Mode 2: Combine Columns ==========

            combineBtn.addEventListener('click', () => {
                const input = combineInput.value;

                if (!input.trim()) {
                    showToast('‚ö†Ô∏è Please paste some data');
                    return;
                }

                // Detect or use selected delimiter
                let delimiterInfo;
                const delimiterValue = inputDelimiter.value;

                if (delimiterValue === 'auto') {
                    delimiterInfo = detectDelimiter(input);
                } else {
                    const names = { ',': 'Comma', ';': 'Semicolon', '\t': 'Tab', '|': 'Pipe' };
                    delimiterInfo = { char: delimiterValue, name: names[delimiterValue] || delimiterValue };
                }

                // Parse rows
                let lines = input.split(/\r?\n/).filter(l => l.trim());

                if (skipHeader.checked && lines.length > 0) {
                    lines = lines.slice(1);
                }

                if (lines.length === 0) {
                    showToast('‚ö†Ô∏è No data rows to process');
                    return;
                }

                // Parse columns to use
                let columnsToUse = null;
                if (columnSelect.value.trim()) {
                    columnsToUse = columnSelect.value
                        .split(',')
                        .map(s => parseInt(s.trim()) - 1)
                        .filter(n => !isNaN(n) && n >= 0);
                }

                // Get joiner
                const joiner = outputJoiner.value;

                // Process each line
                const results = [];
                let maxCols = 0;

                for (const line of lines) {
                    const cols = parseCSVLine(line, delimiterInfo.char);
                    maxCols = Math.max(maxCols, cols.length);

                    let selected;
                    if (columnsToUse && columnsToUse.length > 0) {
                        selected = columnsToUse.map(i => cols[i] || '').filter(v => v);
                    } else {
                        selected = cols.filter(v => v);
                    }

                    results.push(selected.join(joiner));
                }

                // Update stats
                statRows.textContent = results.length.toLocaleString();
                statCols.textContent = maxCols.toLocaleString();
                statDelimiter.textContent = delimiterInfo.name;

                // Output
                combineResultArea.value = results.join('\n');
                combineOutput.classList.add('show');

                showToast(`üîó Combined ${results.length} rows`);
            });

            clearCombineBtn.addEventListener('click', () => {
                combineInput.value = '';
                combineResultArea.value = '';
                combineOutput.classList.remove('show');
            });

            copyCombinedBtn.addEventListener('click', () => {
                const text = combineResultArea.value;
                if (text) {
                    copyToClipboard(text);
                }
            });

            // ========== Helpers ==========

            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

        })();
    </script>

    <!-- GA4 Event Tracking -->
    <script>
        (function() {
            // Track tool page landing
            gtag('event', 'tool_landed', {
                'tool_name': 'CSV Line Combiner / Splitter'
            });
            
            // Track tool usage
            function trackToolUsed(inputCount, customValuesUsed, resultGenerated) {
                gtag('event', 'tool_used', {
                    'tool_name': 'CSV Line Combiner / Splitter',
                    'input_count': inputCount || 0,
                    'custom_values_used': customValuesUsed || false,
                    'result_generated': resultGenerated || false
                });
            }
            
            // Expose tracking function globally for this tool
            window.trackToolUsed = trackToolUsed;
        })();
    </script>
</body>
</html>
